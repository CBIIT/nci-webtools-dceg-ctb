{% extends 'base.html' %}
{% load static %}

{% block title %}
    CTB | Oncogenic Driver Search Facility
{% endblock %}

{% block description %}
    Oncogenic Driver Search Facility
{% endblock %}

{% block page_name %}driver_search_facility{% endblock %}

{% block page_header %}
    <div class="container">
        <div class="pt-3">
            <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item active" aria-current="page">Oncogenic Driver Search Facility</li>
                </ol>
            </nav>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mb-3">
                <div class="border rounded bg-light p-4">
                    <div class="content-header d-flex flex-wrap justify-content-between">
                        <h5>Oncogenic Driver Search</h5>
                    </div>
                    <div class="py-3">
                        <p>This section of the search facility enables you to refine your search using oncogenic
                            drivers that have been identified in tumor samples as a result of research studies
                            using other samples from the same patients that match your search criteria. Data has
                            been pooled from three research studies, all of which have used either whole genome
                            sequencing or next generation sequencing/RNAseq.</p>
                        <p>Please note that this part of the search facility is currently restricted to oncogenic
                            drivers in Papillary Thyroid Carcinoma. Currently this data is available on 515
                            Papillary Carcinomas in which a unique driver has been identified. In 20 of these cases,
                            no driver mutations have yet been identified. If you wish to include these in your
                            search, please ensure that you select "NYI" in the menu below.</p>
                        <p>Oncogenic drivers fall into two categories â€“ fusion events or mutation events. Many
                            oncogenic driver genes can have multiple partners involved in fusions, for example the
                            RET oncogene (see this recent <a href="https://pubmed.ncbi.nlm.nih.gov/32326537/"
                                                             target="_blank" rel="noopener">review by Santoro et
                                al</a>., for more information). The search facility groups these together, so if you
                            select Fusion.RET, all of your selected cases that harbour any form of RET fusion gene
                            will be returned. This is true for sother fusion drivers with multiple possible
                            partners. If you require samples that harbour specific oncogenic fusions, please detail
                            this in your application.
                        </p>
                        <p>Similarly, if you select Mut.Ras, the selected cases may harbour mutations in any of the
                            3 RAS oncogenes. If you require samples that harbour specific RAS mutations, please
                            detail this in your application.</p>
                        <p>The table below gives you the total number of cases which harbour the individual
                            oncogenic drivers included in the dropdown menu that may be available. The actual number
                            that would be available for your study will depend on the biospecimens you require plus
                            any clinical data also requested.</p>
                    </div>
                    {#                        <a href="#" class="content-readmore__link closed">Read more <img class="icon"#}
                    {#                                                                                         src="/getfile/design/icons/icon-arrow-left-blue.svg"#}
                    {#                                                                                         alt=""></a>#}
                    {#                    </div>#}


                    <hr>

                    <h5>Current Samples</h5>

                    <div class="py-3">The table below gives you the total number of cases which harbour the individual
                        oncogenic
                        drivers included in the selection lists that may be available. The actual number that would be
                        available for your study will depend on the biospecimens you require plus any clinical data also
                        requested. In brackets are the drivers that also meet the search criteria you entered in the
                        biosample search and the clinical search.
                    </div>
                    <table class="table table-striped table-sm">
                        <thead>
                        <tr>
                            <th class="text-end">Fusion Drivers</th>
                            <th colspan="2" class="text-center">Cases</th>
                            <th class="text-end">Mutated Drivers</th>
                            <th colspan="2" class="text-center">Cases</th>
                            <th class="text-end">Not Yet Id'd</th>
                            <th colspan="2" class="text-center">Cases</th>
                        </tr>
                        </thead>
                        <tbody class="text-end">
                        <tr>
                            <td>Fusion.ALK</td>
                            <td>{{ counts.Fusion_ALK.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_ALK.filtered|default:0 }})</td>
                            <td>Mut.APC</td>
                            <td>{{ counts.Mut_APC.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_APC.filtered|default:0 }})</td>
                            <td>NYI</td>
                            <td>{{ counts.NYI.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.NYI.filtered|default:0 }})</td>
                        </tr>
                        <tr>
                            <td>Fusion.BRAF</td>
                            <td>{{ counts.Fusion_BRAF.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_BRAF.filtered|default:0 }})</td>
                            <td>Mut.BRAFV600E</td>
                            <td>{{ counts.Mut_BRAFV600E.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_BRAFV600E.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td>Fusion.IGF2/IGF2BP3</td>
                            <td>{{ counts.Fusion_IGF2_IGF2BP3.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_IGF2_IGF2BP3.filtered|default:0 }})</td>
                            <td>Mut.BRAF_other</td>
                            <td>{{ counts.Mut_BRAF_other.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_BRAF_other.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td>Fusion.LTK</td>
                            <td>{{ counts.Fusion_LTK.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_LTK.filtered|default:0 }})</td>
                            <td>Mut.DICER1</td>
                            <td>{{ counts.Mut_DICER1.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_DICER1.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td>Fusion.NTRK1</td>
                            <td>{{ counts.Fusion_NTRK1.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_NTRK1.filtered|default:0 }})</td>
                            <td>Mut.NFE2L2</td>
                            <td>{{ counts.Mut_NFE2L2.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_NFE2L2.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td>Fusion.NTRK3</td>
                            <td>{{ counts.Fusion_NTRK3.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_NTRK3.filtered|default:0 }})</td>
                            <td>Mut.RAS</td>
                            <td>{{ counts.Mut_RAS.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_RAS.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td>Fusion.PPARG</td>
                            <td>{{ counts.Fusion_PPARG.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_PPARG.filtered|default:0 }})</td>
                            <td>Mut.TSC</td>
                            <td>{{ counts.Mut_TSC.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_TSC.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td>Fusion.RET</td>
                            <td>{{ counts.Fusion_RET.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Fusion_RET.filtered|default:0 }})</td>
                            <td>Mut.TSHR</td>
                            <td>{{ counts.Mut_TSHR.total|default:0 }}</td>
                            <td class="fw-bold">({{ counts.Mut_TSHR.filtered|default:0 }})</td>
                            <td colspan="3">&nbsp;</td>
                        </tr>
                        </tbody>
                    </table>

                    <div class="pt-2">The references for the sources of the data that are relevant to the samples that
                        meet your search
                        criteria will be provided to you with the biosamples requested on approval of your application.
                        The relevant references should be quoted in any publication resulting from your study.
                    </div>
                    <hr>
                    <form id="save-form">
                        {% csrf_token %}
                        <input type="hidden" name="filter_encoded_url" value="{{ filter_encoded_url }}"/>
                        <input type="hidden" name="search_type" value="Driver"/>
                        <input type="hidden" name="total" value="{{ total_filtered_case_count }}"/>
                        <div class="d-grid gap-2">
                            <div class="input-group">
                                <input type="text" name="title" id="search-save-title"
                                       class="form-control" value="" placeholder="Search Name"
                                       aria-label="Save Search" aria-describedby="search-save">
                                <button id="search-save" class="btn btn-primary" type="button" id="search-save"><i
                                        class="fa-solid fa-floppy-disk"></i> Save Search
                                </button>
                            </div>
                        </div>
                        <div class="text-end mb-3">
                            <div id="save_message" class="text-primary fw-bold my-2"></div>
                            <div id="alert_message" class="text-primary my-2"></div>
                        </div>
                    </form>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="border rounded bg-light p-3 mb-4">
                    <div class="d-grid gap-2 col mx-auto">
                        <a class="btn btn-outline-secondary" href="{% url 'search_tissue_samples' %}"><i
                                    class="fas fa-angle-double-left"></i> Back to Biosample Search Facility</a>
                        <a class="btn btn-outline-secondary" href="{% url 'clinical_search_facility' %}"><i
                                    class="fas fa-angle-double-left"></i> Perform Another Clinical Search</a>
                        <a class="btn btn-secondary" role="button" href="{% url 'make_application' %}">
                            <i class="fas fa-edit"></i> Make Application
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block js_file %}
    {{ block.super }}
    <script type="text/javascript" src="{% static 'js/save_search.js' %}?v={{ APP_VERSION }}"></script>
{% endblock %}